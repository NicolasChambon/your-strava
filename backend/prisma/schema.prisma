// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String    @id @default(cuid())
  stravaUserId   BigInt    @unique
  accessToken    String
  refreshToken   String
  expiresAt      DateTime
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  activities     Activity[]
}

model Activity {
  id                    String    @id @default(cuid())
  stravaActivityId      BigInt    @unique
  userId                String
  user                  User      @relation(fields: [userId], references: [id])
  stravaUserId          BigInt
  stravaUploadId        BigInt?
  name                  String
  distance              Float
  movingTime            Int
  elapsedTime           Int
  totalElevationGain    Float
  elevHigh              Float?
  elevLow               Float?
  sportTypeId           String
  sportType             SportType @relation(fields: [sportTypeId], references: [id])
  startDate             DateTime
  startDateLocal        DateTime
  timezone              String
  startLatlng           Float[]
  endLatlng             Float[]
  achievementCount      Int
  kudosCount            Int
  commentCount          Int
  athleteCount          Int
  totalPhotoCount       Int
  summaryPolyline       String?
  trainer               Boolean
  commute               Boolean
  manual                Boolean
  private               Boolean
  flagged               Boolean
  workoutType           Int?
  averageSpeed          Float
  maxSpeed              Float
  hasKudoed             Boolean
  gearId                String?
  kilojoules            Float?
  averageWatts          Int?
  deviceWatts           Boolean?
  maxWatts              Int?
  weightedAverageWatts  Int?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
}

model SportType {
  id    String   @id @default(cuid())
  name  String   @unique

  activities Activity[]
}
 
